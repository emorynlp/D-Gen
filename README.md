# *D-GEN*: Distractor Generation for LLM Evaluations

This repository contains resources for our paper **"*D-GEN*: Automatically Generating Distractors for Reliable LLM Evaluation"**.
The paper is accepted to ACL 2025 Findings. 

## Overview

*D-GEN* is the first open-source Large Language Model (LLM) for distractor generation.  

We evaluate the quality of distractors via **Ranking Alignment Test** and **Entropy Analysis**.


1) **Ranking Alignment Test**

To evaluate the effectiveness of our distractor generation model, we compare two test sets:

- **MMLU**: The original MMLU. The original distractors are considered as gold distractors.
    
- **MMLU-DGEN**: A modified MMLU, where the original distractors are replaced with new distractors generated by *D-GEN*.


<img width="587" alt="스크린샷 2025-04-16 오후 3 27 25" src="https://github.com/user-attachments/assets/70c2bbee-4738-4e9b-8899-77369ade3bee" />

<img width="875" alt="plot_rank3" src="https://github.com/user-attachments/assets/8a967fc4-33d9-43d8-9e77-aca5980c524c" />

2) **Entropy Analysis**

We compute the entropy of the predicted probability distribution over answer choices (A, B, C, and D). 

Entropy quantifies the model's prediction uncertainty, allowing us to analyze how convincing the distractors are based on the model's confidence. 

<img width="622" alt="스크린샷 2025-04-16 오후 3 31 01" src="https://github.com/user-attachments/assets/e4fa48ee-bd81-431d-acb2-eaf2444d6441" />

We observe no significant entropy differences between MMLU and MMLU-DGEN for most models, as shown in the Table above.



## Model and Dataset
Models are released in two sizes: 8B and 70B.

They can be found on Hugging Face:  

- [SungJoo/DGEN-llama3.1-8B](https://huggingface.co/SungJoo/DGEN-llama3.1-8B)  

- [SungJoo/DGEN-llama3.3-70B](https://huggingface.co/SungJoo/DGEN-llama3.3-70B)

The MMLU-DGEN dataset is available at:  

- [SungJoo/mmlu_dgen](https://huggingface.co/datasets/SungJoo/mmlu_dgen)


## Contact 

Please contact Grace Byun (gbyun@emory.edu) for any inquiries.
